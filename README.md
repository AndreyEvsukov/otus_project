# Telegram-бот для отслеживания финансовых инструментов

## Описание проекта

Проект представляет собой Telegram-бота, который предоставляет актуальную информацию о:
- Курсах валют к российскому рублю по данным Центрального Банка РФ
- Ценах акций, торгуемых на Московской бирже

Бот позволяет пользователям получать финансовую информацию в удобном формате прямо в мессенджере Telegram.

## Источники данных

### Данные с сайта Центрального Банка РФ

Для получения информации о валютах используется класс `CbrApiClientImpl`, который реализует взаимодействие с официальным API ЦБ РФ.

**Как это работает:**
1. **Формат данных:** ЦБ РФ предоставляет данные в XML-формате в кодировке windows-1251
2. **Получение справочника валют:**
    - Запрос отправляется по адресу: `https://www.cbr.ru/scripts/XML_valFull.asp`
    - Возвращается полный перечень валют с их кодами, наименованиями и другими характеристиками
3. **Получение текущих курсов:**
    - Запрос отправляется по адресу: `https://www.cbr.ru/scripts/XML_daily.asp`
    - Возвращаются актуальные курсы валют по отношению к рублю
4. **Особенности реализации:**
    - Используется кодировка windows-1251 для корректного отображения кириллических символов
    - Реализована обработка ошибок и повторные попытки запросов при сбоях
    - Добавлены таймауты для избежания зависаний при медленных ответах сервера

### Данные с Московской биржи

Для получения информации об акциях используется класс `MoexApiClientImpl`, который взаимодействует с открытым API Московской биржи.

**Как это работает:**
1. **Формат данных:** Московская биржа предоставляет данные в JSON-формате
2. **Получение списка ценных бумаг:**
    - Запрос отправляется по адресу: `http://iss.moex.com/iss/engines/stock/markets/shares/securities.json`
    - Возвращается перечень всех акций, торгуемых на бирже
    - Из этого перечня остаются только бумаги входящие в листинг первого уровня, торгуемые на основной площадке TQBR
3. **Получение цен акций:**
    - Запрос отправляется по адресу: `http://iss.moex.com/iss/engines/stock/markets/shares/boards/TQBR/securities/{тикер}.json`
    - Для каждого тикера формируется индивидуальный URL
    - Возвращаются текущие рыночные данные по конкретной акции
4. **Особенности реализации:**
    - Используется Jackson для парсинга сложных JSON-структур
    - Данные разделяются на метаданные и рыночную информацию
    - Реализована обработка ошибок для каждого запроса

## Технические особенности

- Оба клиента используют асинхронные HTTP-запросы через WebClient
- Реализована обработка сетевых ошибок и повторные попытки соединения
- Данные кэшируются для уменьшения нагрузки на API-сервисы

Для работы с ботом пользователю достаточно отправить код валюты (например, USD) или тикер акции (например, SBER), чтобы получить актуальную финансовую информацию.
